<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Oasis - VISA</title>
    <meta name="description" content="Digital museum">
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="js/aframe-environment-map-component.min.js"></script>
    <script
        src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

        <style>
        .cameraview {
          float: right;
          z-index: 999;
          position: fixed;
          right:40px;
          top:40px;
        }

        .glow {
          font-size:3em;
          color:#fff;
          text-align: center;
          -webkit-animation: glow 2s ease-in-out infinite alternate;
          -moz-animation: glow 2s ease-in-out infinite alternate;
          animation: glow 2s ease-in-out infinite alternate;
          cursor: pointer;
        }

        span {
        background-color: transparent;
        }

        @-webkit-keyframes glow {
          from {
            text-shadow: 0 0 10px #ffd1dc, 0 0 20px #ffd1dc, 0 0 30px #ffd1dc, 0 0 40px #ffd1dc, 0 0 50px #ffd1dc, 0 0 60px #ffd1dc, 0 0 70px #ffd1dc;
          }

          to {
            text-shadow: 0 0 20px #b19cd9, 0 0 30px #b19cd9, 0 0 40px #b19cd9, 0 0 50px #b19cd9, 0 0 60px #b19cd9, 0 0 70px #b19cd9, 0 0 80px #b19cd9;
          }
        }
        </style>
</head>

<body>


<!-- icons for camera view change -->
    <div class="cameraview">
      <span class='tog'>
        <i class="fas fa-street-view glow" id="streetview"></i>
        <i style="display:none;" class="fas fa-dove glow" id="birdview"></i>
      </span>
    </div>

    <a-scene device-orientation-permission-ui="enabled: false" environment="
    preset: forest;
    skyColor: #15c7ff" environment-map>
        <!-- Asset Loader -->
        <a-assets>
            <!-- Load Font -->
            <a-asset-item id="EXO" src="https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-asset-item>
        </a-assets>


        </a-entity>
        <!-- Add Camera -->
        <a-entity position="0 1.6 0" camera look-controls wasd-controls cam-manager animation="property: position; dur: 750; easing: easeInQuad; startEvents: toggle; loop: 0">
          <!-- <a-cursor></a-cursor> -->
        </a-entity>



    </a-scene>


    <!-- Click Function -->
    <script>


// icon image toggle change streetview to birdview
$('.tog').on('click', function (){
$('i').toggle();
})

  AFRAME.registerComponent("cam-manager", {
    init: function() {
      var btn = document.querySelector("i")
      var flying = false
      var currentV = new THREE.Vector3()
      var targetV = new THREE.Vector3()

      btn.addEventListener('click', e => {
          btn.setAttribute('disabled', "")

        // lock the controls
        this.el.setAttribute("wasd-controls", "enabled", false)

        // grab positions for the the animation component
        currentV.copy(this.el.getAttribute('position'))
        targetV.copy(this.el.getAttribute('position'))
        targetV.y = flying ? 1.6 : 6
				// update the animation component
        this.el.setAttribute("animation", {
          from: AFRAME.utils.coordinates.stringify(currentV),
          to: AFRAME.utils.coordinates.stringify(targetV)
        })
        this.el.emit('toggle')
      })

      // once the animation is finished - enable the controls and the button
      this.el.addEventListener("animationcomplete", e => {
          btn.removeAttribute('disabled')
          flying = !flying
          let acceleration = flying ? 40 : 65
          this.el.setAttribute("wasd-controls", {
            "fly": flying,
            "enabled": true,
            "acceleration": acceleration
          })
        })
    }
  })
</script>

</body>
